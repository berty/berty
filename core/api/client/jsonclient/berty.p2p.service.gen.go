// this file was generated by protoc-gen-gotemplate

package jsonclient

import (
	"context"
	"encoding/json"

	"berty.tech/core/api/client"
	"berty.tech/core/api/p2p"
	"go.uber.org/zap"
)

func init() {
	registerUnary("berty.p2p.HandleEnvelope", P2pHandleEnvelope)
	registerUnary("berty.p2p.Ping", P2pPing)
}

func P2pHandleEnvelope(client *client.Client, ctx context.Context, jsonInput []byte) (interface{}, error) {
	logger().Debug("client call",
		zap.String("service", "Service"),
		zap.String("method", "HandleEnvelope"),
		zap.String("input", string(jsonInput)),
	)

	var typedInput p2p.Envelope
	if err := json.Unmarshal(jsonInput, &typedInput); err != nil {
		return nil, err
	}
	return client.P2p().HandleEnvelope(ctx, &typedInput)
}

func P2pPing(client *client.Client, ctx context.Context, jsonInput []byte) (interface{}, error) {
	logger().Debug("client call",
		zap.String("service", "Service"),
		zap.String("method", "Ping"),
		zap.String("input", string(jsonInput)),
	)

	var typedInput p2p.Void
	if err := json.Unmarshal(jsonInput, &typedInput); err != nil {
		return nil, err
	}
	return client.P2p().Ping(ctx, &typedInput)
}
